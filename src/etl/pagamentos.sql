
with payment_type as (

    select
    from pedido as pd
    left join

    select *
    from pedido
    where dtPedido < '2018-01-01'
        and dtPedido >= date('2018-01-01', '-6 month')

)